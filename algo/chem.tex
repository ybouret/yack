\documentclass[aps,12pt]{revtex4}
\usepackage[a4paper]{geometry}
\usepackage{graphicx}
\usepackage{amssymb,amsfonts,amsmath,amsthm}
\usepackage{bm}
\usepackage{pslatex}
\usepackage{mathptmx}
\usepackage{bookman}
\usepackage{chemarr}

 	 
\begin{document}

\section{Notations}

Let $A_1,\ldots,A_M$ be $M$ species involved in $N$ equilibria:
\begin{equation}
	\forall i\in[1:N], \; \sum_j \nu_{i,j} A_j = 0
\end{equation}
and
\begin{equation}
	\forall i\in[1:N], \; 
	\Gamma_i = K_i \prod_{j=1}^{M} [A_j]^{\nu^r_{ij}} 
	- \prod_{j=1}^{M} [A_j]^{\nu^p_{ij}} = 0
\end{equation}

\begin{itemize}
\item $\Gamma_i$ has the sign of $\Delta_r G_i$.
\item The unit of $\Gamma_i$ is $C_0^{\sum_j \nu^p_{ij} }$
\item The unit of $K_i$ is $C_0^{\Delta_r \nu}$
\end{itemize}


\section{Derivatives}
We express the derivative of a product w.r.t. one term:
\begin{equation}
	\partial_{A_k} \left( \prod_{j=1}^{M} [A_j]^{\nu_{j}} \right)  =
	\nu_k [A_k]^{\nu_k-1} \left( \prod_{j=1,j\not=k}^{M} [A_j]^{\nu_{j}} \right)
\end{equation}

Then:
\begin{equation}
	\partial^2_{A_k, A_k} \left( \prod_{j=1}^{M} [A_j]^{\nu_{j}} \right)  =
	\nu_k (\nu_k-1) [A_k]^{\nu_k-2} \left( \prod_{j=1,j\not=k}^{M} [A_j]^{\nu_{j}} \right)
\end{equation}
and:
\begin{equation}
	\partial^2_{A_k\not=A_l} \left( \prod_{j=1}^{M} [A_j]^{\nu_{j}} \right)  =
	\nu_k [A_k]^{\nu_k-1} \nu_l [A_l]^{\nu_l-1}\left( \prod_{j=1,j\not=k,j\not=l}^{M} [A_j]^{\nu_{j}} \right)
\end{equation}

\begin{equation}
	\vec{\Psi}_i = \partial_{\vec{C}} \Gamma_i
\end{equation}

%\section{Subtracting Equation}
%
%Let $\vec{V}_1\not=\vec{0}$ and $\vec{V}_2\not=\vec{0}$.
%The smallest weighted difference is:
%\begin{equation}
%	\delta \vec{V} = \dfrac{1}{\left(\vec{V}_1+\vec{V}_2\right)^2} \left[ 
%	\langle \vec{V}_2 | \vec{V}_1+\vec{V}_2 \rangle \vec{V}_1 - \langle \vec{V}_1 | \vec{V}_1+\vec{V}_2 \rangle \vec{V}_2
%	\right]
%\end{equation}

\section{1D-Solving}

\subsection{Solution}

Let us take $\Gamma_i$ (with a least a product or a reactant).
Then there exist a unique $\Xi_i$ for which:
\begin{equation}
\left\lbrace
\begin{array}{rcl}
	\Gamma_i(\vec{C} + \Xi_i \vec{\nu}_i ) & = & 0\\
	 \Xi_i \times \Gamma_i(\vec{C}) &\geq  &0\\
\end{array}
\right.
\end{equation}
 
Indeed, $\Xi_i$ is solution of:
\begin{equation}
	 F_i(\vec{C},X) =  K_i \prod_{j=1}^{M} \left([A_j] - X \nu^r_{ij}\right)^{\nu^r_{ij}} 
	- \prod_{j=1}^{M} \left([A_j] + X \nu^p_{ij} \right)^{\nu^p_{ij}} = 0
\end{equation} 

And each $\Xi_i$ respects all the limiting extents.


Let us set:
\begin{equation}
\left\lbrace
\begin{array}{rcll}
	P_i(\vec{C},X) & = & \displaystyle \prod_{j=1}^{M} \left([A_j] + X \nu^p_{ij} \right)^{\nu^p_{ij}}, & \partial_X P_i(\vec{C},X) > 0 \\
	\\
	R_i(\vec{C},X) & = & \displaystyle K_i \prod_{j=1}^{M} \left([A_j] - X \nu^r_{ij}\right)^{\nu^r_{ij}}, & \partial_X R_i(\vec{C},X) < 0 \\
	\\
	 F_i(\vec{C},X) & = & R_i(\vec{C},X)  - P_i(\vec{C},X), & \partial_X F_i(\vec{C},X) < 0\\
\end{array}
\right.
\end{equation}

Let
\begin{equation}
	\sigma_i = \mathrm{sign}\lbrack P_i(\vec{C},0) \rbrack
\end{equation}

\begin{itemize}

\item If $\sigma_i=0$ then $X=0$ is solution at $\vec{C}$...

\item Otherwise, we compute the limits of $F_i$.
	
	\begin{itemize}
	%%%%%%%%
	\item If $F_i$ is limited by none, then the equilibrium is \textbf{invalid}.

	%%%%%%%%
	\item If $F_i$ is limited by a reactant, meaning a "combination only" equilibrium:
		\begin{equation}
		\left\lbrace
			\begin{array}{rcl}
			P_i   & \equiv & 1\\
			X     & \in & \rbrack-\infty;\xi_r\lbrack\\
			R_i(\vec{C},\xi_r)  & = & 0 \\
 			F_i(\vec{C},\xi_r)  & = & -1 \\
			\end{array}
		\right.
		\end{equation}
		\begin{itemize}
			\item if $\sigma_i>0$, then we have $X\in\rbrack 0;\xi_r \lbrack$
			\item if $\sigma_i<0$, then we must find $\xi_0<0$ such that $F_i(\vec{C},\xi_0)>0$,
			then $X\in\rbrack \xi_0;0\lbrack$.
			We can start from $\xi_0 \approx -  K_i^{\frac{1}{\Delta_r \nu}}$ and decrease it until a total positive mass action is found.
		\end{itemize}
		
 	%%%%%%%%
 	\item If $F_i$ is limited by a product, meaning a "dissociation only" equilibrium:
	\begin{equation}
		\left\lbrace
			\begin{array}{rcl}
			R_i   & \equiv & K_i\\
			X     & \in & \rbrack \xi_p<0 ; +\infty \lbrack\\
			P_i(\vec{C},\xi_p)  & = & 0 \\
 			F_i(\vec{C},\xi_p)  & = & K_i \\
			\end{array}
		\right.
		\end{equation}

	
    	\begin{itemize}
    	\item if $\sigma_i<0$, then we must have $X\in\rbrack \xi_p;0\lbrack$.
    	\item if $\sigma_i>0$, then we must find $\xi_0>0$ such that $F_i(\vec{C},\xi_0)<0$,
    		then $X\in\rbrack 0; \xi_0 \lbrack$.
    		We can start from $\xi_0 \approx K_i^{\frac{1}{\Delta_r \nu}}$ and increase it until a total negative mass action is found.
    	\end{itemize}

	%%%%%%%%
	\item If $F_i$ is limited by both a product and a reactant, then $$X\in\rbrack \xi_p < 0 ; \xi_r > 0 \lbrack$$
	and depending on $\sigma_i$, the proper interval is chosen.
	\end{itemize}
	
\end{itemize}



\subsection{Regularization}
We define:
\begin{equation}
\vec{\Psi}_i = \partial_{\vec{C}} \Gamma_i.
\end{equation}
If $|\vec{\Psi}_i|=0$, then we solve $\Gamma_i$. If we still have $|\vec{\Psi}_i|=0$, we declare $\Gamma_i$ blocked.

\subsection{Behavior}
We have $\vec{C}_i'=\vec{C} + \vec{\delta}_i$ and $\vec{\delta}_i = \Xi_i \vec{\nu}_i$ such that:
\begin{equation}
	\Gamma_i(\vec{C}_i') = 0
\end{equation}

\begin{enumerate}
\item
\begin{equation}
	\Gamma_i(\vec{C} + x \vec{\delta}_i) \simeq (1-x) \Gamma_i
\end{equation}

\item
\begin{equation}
\begin{array}{rcl}
	\Gamma_i(\vec{C} + x  \vec{\delta}_i) & \simeq & \Gamma_i -g_i x + h_i x^2\\
	g_i & = & 2\Gamma_i + \Xi_i \langle\vec{\Psi}_i'  \vert \vec{\nu}_i \rangle\\
	h_i & = & \Gamma_i + \Xi_i \langle\vec{\Psi}_i'  \vert \vec{\nu}_i \rangle\\
\end{array}
\end{equation}

\end{enumerate}
 

 
\subsection{Evolution}
Let us start from a regular $\vec{C}$.

\begin{equation}
	\vec{\Gamma}(\vec{C}+\bm{\nu}^T \vec{\xi}) \simeq \vec{\Gamma} + \bm{\Psi} \bm{\nu}^T \vec{\xi}
\end{equation}
For a regular concentration,
\begin{equation}
	\langle\vec{\Psi}_i \vert \vec{\nu}_i\rangle < 0
\end{equation}
and is a scaling factor for $\Gamma_i$. So we want to solve
\begin{equation}
	\forall i, \;\; \langle \vec{\Omega}_i \vert \vec{\xi} \rangle = \dfrac{\Gamma_i}{-\langle\vec{\Psi}_i \vert \vec{\nu}_i\rangle}
\end{equation}
\begin{equation}
\left\lbrace
	\begin{array}{rcl}
	\Omega_{ii}   & = & 1\\
	\Omega_{i\not=j} & = & \dfrac{\langle\vec{\Psi}_i \vert \vec{\nu}_j\rangle}{\langle\vec{\Psi}_i \vert \vec{\nu}_i\rangle}\\
	\end{array}
\right.
\end{equation}

\begin{equation}
	f = \dfrac{1}{2} \vec{\Gamma}^2 \Rightarrow \vec{\nabla} f = \left(\bm{\Psi} \bm{\nu}^T\right)^T \vec{\Gamma}
\end{equation}

\begin{equation}
	f = \dfrac{1}{2} \langle \vec{\Gamma} \vert \bm{W}^2 \vert \vec{\Gamma} \rangle \Rightarrow \vec{\nabla} f = \left(\bm{W}\bm{\Psi} \bm{\nu}^T\right)^T \bm{W}\vec{\Gamma}
\end{equation}

\subsection{Moving}

Let us assume that we start from $\vec{C}$ and for each $\Gamma_i$ we know $\Xi_i$ such that $\Gamma_i(\vec{C} + \Xi_i \vec{\nu}_i) =0$
If we now move slightly by $\delta\vec{C}$, the equilibrium will react with $\delta\Xi_i$ such that:
\begin{equation}
	\Gamma_i(\vec{C} + \Xi_i \vec{\nu}_i + \delta\vec{C} + \delta\Xi_i \vec{\nu}_i) = 0
\end{equation}
and we find:
\begin{equation}
	\delta \Xi_i \simeq - \dfrac{\langle \vec{\Psi}_i' \vert \delta\vec{C}\rangle}{\langle \vec{\Psi}_i' \vert \vec{\nu}_i \rangle}
\end{equation}
 
\begin{equation}
	\rho^2(\delta\vec{C}) = \dfrac{1}{2} \sum_i \left[ \Xi_i + \delta\Xi_i \right]^2
\end{equation} 

\begin{equation}
	- \vec{\nabla} \rho^2_0 = \sum_i \dfrac{\Xi_i}{\langle \vec{\Psi}_i' \vert \vec{\nu}_i \rangle} \vec{\Psi}_i'
\end{equation}


\subsection{Global Topology}

\begin{equation}
\begin{array}{rcl}
	\Gamma_i \left(\vec{C} + \sum_k \alpha_k \vec{\delta}_k \right) & = & 
	\Gamma_i \left(\vec{C}_i' + (\alpha_i-1) \vec{\delta}_i + \sum_{k\not=i} \alpha_k \vec{\delta}_k \right)\\
	& \simeq & \langle \vec{\Psi}_i' \vert (\alpha_i-1) \vec{\delta}_i + \sum_{k\not=i} \alpha_k \vec{\delta}_k \rangle \text{ (around $\alpha_i=1$)}\\
	& \simeq & -\langle \vec{\Psi}_i'\vert \vec{\nu}_i \rangle \Xi_i + \sum_k \langle \vec{\Psi}_i'\vert \vec{\nu}_k \rangle \alpha_k \Xi_k \\
\end{array}
\end{equation}
Then
\begin{equation}
	\dfrac{\Gamma_i\left(\vec{C} + \sum_k \alpha_k \vec{\delta}_k \right)}{\langle \vec{\Psi}_i'\vert \vec{\nu}_i \rangle} \simeq
	-\Xi_i + \sum_k \Omega_{ik} \alpha_k \Xi_k
\end{equation}


\end{document}