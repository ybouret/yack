\documentclass[aps,onecolumn,11pt]{revtex4}
\usepackage{graphicx}
\usepackage{amssymb,amsfonts,amsmath,amsthm}
\usepackage{bm}
\usepackage{xfrac}
\usepackage{chemarr}

\usepackage{bookman}


\begin{document}
\title{Spline}
\maketitle

\subsection{Definition}
Let $(x_i,\ldots,y_i)_{i\in[1:N]}$ be a set of points, $y_i\in\mathbb{R}^d$, increasing $x_i$.
The linear interpolation on $[x_i,x_{i+1}]$ is:
\begin{equation}
	y = A(x) y_i + B(x) y_{i+1},\;\;A(x) = \dfrac{x_{i+1}-x}{x_{i+1}-x_{i}}, \;\; B(x)=1-A(x) = \dfrac{x-x_i}{x_{i+1}-x_{i}}
\end{equation}
Let us define a spline with continuous first derivative using a linear second derivative:

\begin{equation}
 	y = A(x) y_i + B(x) y_{i+1} + C(x) y_i'' + D(x) y_{i+1}''
\end{equation}

\begin{equation}
	C(x) = \dfrac{1}{6}(A(x)^3 - A(x))(x_{i+1} - x_i)^2  
\end{equation}

\begin{equation}
	D(x) = \dfrac{1}{6}(B(x)^3 - B(x))(x_{i+1} - x_i)^2  
\end{equation}

We get the linear evolution of $y''$:
\begin{equation}
	y'' = A(x) y_i'' + B(x) y_{i+1}''
\end{equation}
and we deduce:
\begin{equation}
	y' = \dfrac{y_{i+1}-y_{i}}{x_{i+1}-x_{i}} - \dfrac{3A^2-1}{6}(x_{i+1} - x_i) y_i''+ \dfrac{3B^2-1}{6}(x_{i+1} - x_i) y_{i+1}''
\end{equation}

\begin{equation}
	y'_i = \dfrac{y_{i+1}-y_{i}}{x_{i+1}-x_{i}} - \dfrac{(x_{i+1} - x_i)}{3} y_i'' - \dfrac{(x_{i+1} - x_i)}{6} y_{i+1}''
\end{equation}

\begin{equation}
	y'_{i+1} = \dfrac{y_{i+1}-y_{i}}{x_{i+1}-x_{i}} + \dfrac{(x_{i+1} - x_i)}{6} y_i'' + \dfrac{(x_{i+1} - x_i)}{3} y_{i+1}''
\end{equation}

\subsection{Continuity of first derivative}

$$
	y_{(i-1)+1}' = y_i'
$$
	
\begin{equation}
		\dfrac{y_{i}-y_{i-1}}{x_{i}-x_{i-1}} + \dfrac{(x_{i} - x_{i-1})}{6} y_{i-1}'' + \dfrac{(x_{i} - x_{i-1})}{3} y_{i}''
		=
		\dfrac{y_{i+1}-y_{i}}{x_{i+1}-x_{i}} - \dfrac{(x_{i+1} - x_i)}{3} y_i'' - \dfrac{(x_{i+1} - x_i)}{6} y_{i+1}''
\end{equation}
	
\begin{equation}
  \underbrace{\dfrac{(x_{i} - x_{i-1})}{6}}_{a_i} y_{i-1}''
+ \underbrace{\dfrac{x_{i+1}-x_{i-1}}{3}}_{b_i} y_i''
+ \underbrace{\dfrac{(x_{i+1} - x_i)}{6}}_{c_i} y_{i+1}'' = 
\underbrace{\dfrac{y_{i+1}-y_{i}}{x_{i+1}-x_{i}} - \dfrac{y_{i}-y_{i-1}}{x_{i}-x_{i-1}}}_{\delta_i}
\end{equation}	
	
\subsection{Open Spline}
There are $N-2$ interior points, and we need two conditions for $x_1$ and $x_N$.

\begin{equation}
\begin{bmatrix}
b_1  & c_1 &     &         &         &         \\
     & a_2 & b_2 & c_2     &         &         \\
     &     & a_i & b_i     & c_i     &         \\
     &     &     & a_{N-1} & b_{N-1} & c_{N-1} \\
     &     &     &         &   a_N   & b_N     \\
\end{bmatrix}
\begin{bmatrix}
	y_1''\\
	y_2''\\
	y_i''\\
	y_{N-1}''\\
	y_N''\\
\end{bmatrix}
 = 
 \begin{bmatrix}
 	r_1\\
	\delta_2\\
	\delta_i\\
	\delta_{N-1}\\
	r_N\\
 \end{bmatrix}
\end{equation}

\begin{itemize}
\item Natural at $x_1$:
\begin{equation}
	y_1'' = 0 \Rightarrow  b_1=1,\;c_1=0,\;r_1=0
\end{equation}
\item Natural at $x_N$:
\begin{equation}
	y_N'' = 0 \Rightarrow a_N=0,\;b_N=1,\;r_1=0
\end{equation}

\item $y_1'$ at $x_1$:
\begin{equation}
	y_1' = \dfrac{y_2-y_1}{x_2-x_1} - \dfrac{(x_{2} - x_1)}{3} y_1'' - \dfrac{(x_{2} - x_1)}{6} y_{2}''
\end{equation}
$$
	\Rightarrow a_1=\dfrac{x_2-x_1}{3}, b_1=\dfrac{x_2-x_1}{6}, r_1 = \dfrac{y_2-y_1}{x_2-x_1} - y_1'
$$

\item $y_N'$ at $x_N$:
\begin{equation}
	y_N' = \dfrac{y_{N}-y_{N-1}}{x_{N}-x_{N-1}} + \dfrac{(x_{N} - x_{N-1})}{6} y_{N-1}'' + \dfrac{(x_{N} - x_{N-1})}{3} y_{N}''
\end{equation}
$$
	\Rightarrow a_N= \dfrac{(x_{N} - x_{N-1})}{6} , b_N = \dfrac{(x_{N} - x_{N-1})}{3} y_{N}, r_N = y_N' - \dfrac{y_{N}-y_{N-1}}{x_{N}-x_{N-1}}
$$
\end{itemize}

\subsection{Closed Spline}

\begin{equation}
  \underbrace{\dfrac{(x_{N} - x_{N-1})}{6}}_{a_N} y_{N-1}''
+ \underbrace{\dfrac{x_{N+1}-x_{N-1}}{3}}_{b_N} y_N''
+ \underbrace{\dfrac{(x_{N+1} - x_N)}{6}}_{c_N} y_{1}'' = 
\underbrace{\dfrac{y_{1}-y_{N}}{x_{N+1}-x_{N}} - \dfrac{y_{N}-y_{N-1}}{x_{N}-x_{N-1}}}_{\delta_n}
\end{equation}

\begin{equation}
\begin{bmatrix}
a_1  & b_1 &     &         &         &  c_1    \\
     & a_2 & b_2 & c_2     &         &         \\
     &     & a_i & b_i     & c_i     &         \\
     &     &     & a_{N-1} & b_{N-1} & c_{N-1} \\
 c_N &     &     &         &   a_N   & b_N     \\
\end{bmatrix}
\begin{bmatrix}
	y_1''\\
	y_2''\\
	y_i''\\
	y_{N-1}''\\
	y_N''\\
\end{bmatrix}
 = 
 \begin{bmatrix}
 	\delta_1\\
	\delta_2\\
	\delta_i\\
	\delta_{N-1}\\
	\delta_N\\
 \end{bmatrix}
\end{equation}
	
\end{document}
